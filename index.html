<!DOCTYPE html>
<html>
<head>
    <title>Barcode Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/quagga@0.12.1"></script>
    <style>
        #camera {
            width: 300px;
            height: 200px;
            border: 1px solid black;
            display: none;
        }
    </style>
</head>
<body>
    <h1>Barcode Scanner</h1>
    <video id="camera" autoplay></video>
    <button id="scan">Start Scanning</button>
    <button id="stop" style="display: none;">Stop Scanning</button>
    <ul id="scanned-products"></ul>

    <script>
        const productList = {
            "123456789012": "Product A",
            "987654321098": "Product B",
            "072036310200": "HT Table Salt",
            "058496723040": "Cat Treats",
            "692042014710": "EGO Chainsaw Lubricant"
        };
        const scannedItems = [];

        document.getElementById('scan').addEventListener('click', () => {
            document.getElementById('camera').style.display = 'block';
            document.getElementById('scan').style.display = 'none';
            document.getElementById('stop').style.display = 'inline';

            Quagga.init({
                inputStream: {
                    type: "LiveStream",
                    target: document.querySelector('#camera'),
                },
                decoder: {
                    readers: ["ean_reader"] // Adjust to your barcode type
                }
            }, (err) => {
                if (err) {
                    console.error(err);
                    return;
                }
                console.log("Quagga initialized successfully");
                Quagga.start();
            });

            Quagga.onDetected((data) => {
                console.log("Barcode detected:", data);
                const code = data.codeResult.code;
                const product = productList[code] || "Unknown Product";
                if (!scannedItems.includes(product)) {
                    scannedItems.push(product);
                    const listItem = document.createElement("li");
                    listItem.textContent = product;
                    document.getElementById('scanned-products').appendChild(listItem);
                }
            });
        });

        document.getElementById('stop').addEventListener('click', () => {
            Quagga.stop();
            document.getElementById('camera').style.display = 'none';
            document.getElementById('scan').style.display = 'inline';
            document.getElementById('stop').style.display = 'none';
        });
    </script>
</body>
</html>