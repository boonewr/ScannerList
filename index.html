<!DOCTYPE html>
<html>
<head>
    <title>Barcode Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/quagga@0.12.1"></script>
    <style>
        #camera {
            width: 300px;
            height: 200px;
            border: 1px solid black;
            display: block;
        }
    </style>
</head>
<body>
    <h1>Barcode Scanner</h1>
    <div id="camera-container" style="width: 300px; height: 200px;"></div>
    <button id="scan">Start Scanning</button>
    <button id="stop" style="display: none;">Stop Scanning</button>
    <ul id="scanned-products"></ul>

    <script>
        const productList = {
            "123456789012": "Product A",
            "987654321098": "Product B",
            "072036310200": "HT Table Salt",
            "058496723040": "Cat Treats",
            "692042014710": "EGO Chainsaw Lubricant"
        };
        const scannedItems = [];

        const cameraContainer = document.getElementById('camera-container');
        const scanButton = document.getElementById('scan');
        const stopButton = document.getElementById('stop');

        scanButton.addEventListener('click', () => {
            scanButton.style.display = 'none';
            stopButton.style.display = 'inline';

            Quagga.init({
                inputStream: {
                    type: "LiveStream",
                    constraints: {
                        facingMode: "environment", // Use the back camera if available
                        width: 300,
                        height: 200
                    },
                    target: cameraContainer
                },
                decoder: {
                    readers: ["ean_reader"] // Adjust to your barcode type
                }
            }, (err) => {
                if (err) {
                    console.error("Quagga initialization failed:", err);
                    scanButton.style.display = 'inline';
                    stopButton.style.display = 'none';
                    return;
                }
                console.log("Quagga initialized successfully");
                Quagga.start();
            });

            Quagga.onDetected((data) => {
                const code = data.codeResult.code;
                const product = productList[code] || "Unknown Product";
                if (!scannedItems.includes(product)) {
                    scannedItems.push(product);
                    const listItem = document.createElement("li");
                    listItem.textContent = product;
                    document.getElementById('scanned-products').appendChild(listItem);
                }
            });
        });

        stopButton.addEventListener('click', () => {
            Quagga.stop();
            scanButton.style.display = 'inline';
            stopButton.style.display = 'none';
        });
    </script>
</body>
</html>
